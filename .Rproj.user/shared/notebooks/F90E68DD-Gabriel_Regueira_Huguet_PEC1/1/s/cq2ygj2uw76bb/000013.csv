"0","library(reshape2)"
"0","library(ggplot2)"
"0","#Seleccionem els metabòlits que ens han sortit"
"0","top_metabolits <- c(""Glucose"", ""N.N.Dimethylglycine"", ""Adipate"", ""Quinolinate"")"
"0","#Extraiem la matriu només amb els metabòlits seleccionats"
"0","top_data <- assay(cachexia_se)[top_metabolits, ]"
"0","#Preparem les dades per fer ggplot2 (passem les mostres a les files en comptes de les columnes i anyadim la columna grup Muscle.loss)"
"0","top_data_prep <- as.data.frame(t(top_data))"
"0","top_data_prep$group <- colData(cachexia_se)$Muscle.loss #Anyadim la columna grup "
"0","#Format compatible amb bloxplot"
"0","data_metabolits <- reshape2::melt(top_data_prep, id.vars = ""group"","
"0","                                  variable.name = ""metabòlit"","
"0","                                  value.name = ""concentració"")"
"0","#Amb les dades preparades, procedim a fer el boxploit múltiple"
"0","ggplot(data_metabolits, aes( x= metabòlit, y = concentració, fill = group)) + "
"0","  geom_boxplot(outlier.size = 1) +"
"0","  labs(title = ""Boxplot múltiple dels metabòlits més rellevants"","
"0","       x = ""Metabòlit"","
"0","       y = ""Concentració (log10)"") + "
"0","  scale_fill_manual(values = c(""cachexic"" = ""red"", control = ""green"")) + #Separem grups per color"
"0","  scale_y_log10() + #Apliquem escala logaritmica per fer comparables metabolits amb concentracions massa diferents"
"0","  theme_minimal()"
