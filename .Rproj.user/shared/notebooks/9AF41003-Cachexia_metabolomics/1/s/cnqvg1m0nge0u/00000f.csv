"0","library(reshape2)"
"0","library(ggplot2)"
"0","#Seleccionem els metabòlits"
"0","top_metabolits <- c(""Valine"", ""N.N-Dimethylglycine"", ""Leucine"", ""Quinolinate"")"
"0","#Extraïm la matriu només amb els metabòlits seleccionats"
"0","top_data <- assay(se)[top_metabolits, ]"
"0","#Preparem les dades per ggplot2 (passem les mostres a les files en comptes de les columnes i anyadim la columna group ""Muscle.loss"")"
"0","top_data_prep <- as.data.frame(t(top_data))"
"0","top_data_prep$group <- colData(se)$Muscle.loss #Anyadim la columna group"
"0","#Format compatible amb boxplot"
"0","data_met <- reshape2::melt(top_data_prep, id.vars = ""group"","
"0","                           variable.name = ""metabòlit"","
"0","                           value.name = ""concentració"")"
"0","#Amb les dades preparades, procedim a fer el boxplot múltiple"
"0","ggplot(data_met, aes(x = metabòlit, y = concentració, fill = group)) + "
"0","  geom_boxplot(outlier.size = 1) +"
"0","  labs(title = ""Boxplot múltiple dels metabòlits més rellevants"","
"0","       x = ""Metabòlit"","
"0","       y = ""Concentració"") + "
"0","  scale_fill_manual(values = c(""cachexic"" = ""red"", ""control"" = ""green"")) + #Separem grups amb colors (Muscle.loss)"
"0","  theme_minimal()"
